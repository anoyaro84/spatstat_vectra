---
title: "figures generation for thesis"
author: "Erik Bosch"
date: "11/4/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r source, echo=FALSE}
source("spatstat_vectra.R")
library(latex2exp)
```


```{r RUN OakMaple50}
# from https://stackoverflow.com/questions/57434048/how-to-save-ppp-planer-point-pattern-dataframe-or-a-hyperframe-created-from-di
# saveRDS(OakMaple,file = "OakMaple.rds")
# OakMaple = readRDS(file = "OakMaple.rds")

# OakMaple
set.seed(123456789)
OakMaple = rmpoispp(50,types = c("Oak", "Maple"))
par(mfrow=c(1,1))
plot(OakMaple, main=NULL, cols=c("blue","red"),pch=20)
title("Location of Oak and Maple trees in a square property", line = 0)

```

```{r OakMaple20/100}
# estimator_density
set.seed(123456789)
OakMaple20 = rpoispp(20)
Area20 = summary(OakMaple20)$Area
lambda20 = summary(OakMaple20)$intensity

OakMaple100 = rpoispp(100)
Area100 = (OakMaple100$window$xrange[2]-OakMaple100$window$xrange[1])*(OakMaple100$window$yrange[2]-OakMaple100$window$yrange[1])
lambda100 = OakMaple100$n / Area100

par(mfrow=(c(1,2)))
plot(OakMaple20, main = NULL, pch=20)
title(paste("Poisson Process with intensity 20 and estimator", lambda20), line = 0)

plot(OakMaple100, main = NULL,pch=20)
title(paste("Poisson Process with intensity 100 and estimator", lambda100), line = 0)
```

```{r RUN estimators density splitted}
# estimators_density_splitted
set.seed(123456789)

Oak_n = sum(OakMaple$marks =="Oak")
Maple_n = sum(OakMaple$marks =="Maple")
Area = (OakMaple$window$xrange[2]-OakMaple$window$xrange[1])*(OakMaple$window$yrange[2]-OakMaple$window$yrange[1])
lambdaOak = Oak_n / Area
lambdaMaple = Maple_n / Area


OakMaple = rmpoispp(50,types = c("Oak", "Maple"))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE))
plot(OakMaple, main=NULL, cols=c("blue","red"),pch=20)
plot(OakMaple[OakMaple$marks == "Oak"],main=NULL,cols=c("blue","red"),pch=20)
#title(paste("The Point Process of the Oaks in Figure 1 and the density estimator", lambdaOak), line = 0)
plot(OakMaple[OakMaple$marks == "Maple"],main=NULL,cols=c("blue","red"),pch=20)
#title(paste("The Point Process of the Maples  in Figure 1 and the density estimator", lambdaMaple), line = 0)
```

```{r RUN quadratcounts}
#OakMaple_quadratcounts
set.seed(123456789)

layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE))

plot(OakMaple, main=NULL, cols  = c("blue", "red"), pch = 20)
plot(quadratcount(OakMaple), add=TRUE)
title("The Marked Point Process and its quadratcounts", line=0)
plot(OakMaple[OakMaple$marks == "Oak"], main = NULL,cols = c("blue", "red"), pch = 20)
plot(quadratcount(OakMaple[OakMaple$marks == "Oak"]), add=TRUE)
title("The Marked Point Process filtered on the Oaks and its quadratcounts", line=0)
plot(OakMaple[OakMaple$marks == "Maple"], main=NULL, cols = c("blue", "red"), pch = 20)
plot(quadratcount(OakMaple[OakMaple$marks == "Maple"]), add=TRUE)
title("The Marked Point Process filtered on the Maples and its quadratcounts", line=0)
```
```{r RUN homogenous and inhomogenous}
# homogenous and inhomogenous
set.seed(123456789)

homo = rpoispp(20,win = owin(c(0,2),c(0,2)))
unitname(homo) = list("metre", "metres",1)
plot(homo, main = "",  pch = 20)
title(main = TeX('Poisson Point Process created with rate $\\lambda = 20$'),line = 0.5)
lab = function(x,y){
    #return(exp(-x^2-y^2))
    return(x+100*y^2)
}
inhomo = rpoispp(lab ,win = owin(c(0,2),c(0,2)))
unitname(inhomo) = c("metre", "metres")
plot(inhomo, xlab = "", ylab = "", main = "",  pch = 20)
title(main = TeX('Poisson Point Process created with rate $\\lambda(x,y) = x+100y^2$'),line = 0.5)

#plot(Kest(homo)$theo~Kest(homo)$r)
```

```{r RUN counts and area}
# counts and area
set.seed(123456789)

Y150 = rmpoint(c(50,150))
# plot(Y150)
# identify(Y150)
X1 = subset(Y150,marks == 1)
X2 = Y150[197]
Y1 = superimpose(X1,X2)

unitname(Y150) = list("metre", "metres",1)
unitname(Y1) = unitname(Y150)

par(mfrow=(c(1,2)))
plot(Y150, main = "",cols = c("blue", "red"),  pch = 20)
title(main = TeX('Marked Poisson Point Process with 200 points'), sub = TeX('50 points of phenotype 1 and 150 point of phenotype 2'),line = 0.5)
plot(Y1, main = "",cols = c("blue", "red"),  pch = 20)
title(main = TeX('Marked Poisson Point Process with 51 points'), sub = TeX('50 points of phenotype 1 and 1 point of phenotype 2'),line = 0.5)



# title(main = TeX('Poisson Point Process created with rate $\\lambda = 20$'),line = 0.5)

# title(main = TeX('Poisson Point Process created with rate $\\lambda(x,y) = x+100y^2$'),line = 0.5)

#plot(Kest(homo)$theo~Kest(homo)$r)
```

```{r RUN counts and area}
# counts and area
set.seed(123456789)

X = rpoint(50)
Y = X
Window(X) = square(r=1,unitname = list("metre", "metres",1))
Window(Y) = square(r=10,unitname = list("metre", "metres",1))
plot(X,  pch = 20)
plot(Y,  pch = 20)
# title(main = TeX('Poisson Point Process created with rate $\\lambda = 20$'),line = 0.5)

# title(main = TeX('Poisson Point Process created with rate $\\lambda(x,y) = x+100y^2$'),line = 0.5)

#plot(Kest(homo)$theo~Kest(homo)$r)
```

```{r RUN emptyspace}
# OakMaple_emptyspace
set.seed(123456789)

par(mfrow = c(1,2))
plot(OakMaple, main=NULL, cols=c("blue","red"),pch=20)
title("A Marked Point Process on the distribution of Oak and Maple trees", line = 0)
plot(Fest(OakMaple), main= NULL)
title("The Empty Space function for the Marked Point Process", line = 0)
plot(envelope(OakMaple,Fest))

```
```{r NOT RUN good plot and bad plot because of too many phenotypes}
data(lansing)
# good plot because of 3 phenotypes
plot(alltypes(superimpose(blackoak = split(lansing)$blackoak,maple = split(lansing)$maple,hickory = split(lansing)$hickory)), samex = TRUE)
# bad plot because of 4 phenotypes
plot(alltypes(superimpose(blackoak = split(lansing)$blackoak,maple = split(lansing)$maple,hickory = split(lansing)$hickory,misc = split(lansing)$misc)),samex = TRUE)

```
