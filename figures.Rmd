---
title: "figures generation for thesis"
author: "Erik Bosch"
date: "11/4/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r source, echo=FALSE}
source("spatstat_vectra.R")
library(latex2exp)
```


```{r RUN OakMaple50}
# from https://stackoverflow.com/questions/57434048/how-to-save-ppp-planer-point-pattern-dataframe-or-a-hyperframe-created-from-di
# saveRDS(OakMaple,file = "OakMaple.rds")
# OakMaple = readRDS(file = "OakMaple.rds")

# OakMaple
set.seed(123456789)
OakMaple = rmpoispp(50,types = c("Oak", "Maple"))
par(mfrow=c(1,1))
plot(OakMaple, main=NULL, cols=c("blue","red"),pch=20)
title(main = TeX("Location of Oak and Maple trees in a square property"), line = 0.5)
```

```{r OakMaple20/100}
# estimator_density
set.seed(123456789)
OakMaple20 = rpoispp(20)
lambda20 = summary(OakMaple20)$intensity

OakMaple100 = rpoispp(100)
lambda100 = summary(OakMaple100)$intensity

par(mfrow=(c(1,2)))
plot(OakMaple20, main = NULL, pch=20)
title(main = TeX(paste("Poisson Process with intensity 20 and estimator", lambda20)), line = 0.5)

plot(OakMaple100, main = NULL,pch=20)
title(main = TeX(paste("Poisson Process with intensity 100 and estimator", lambda100)), line = 0.5)
```

```{r RUN estimators density splitted}
# estimators_density_splitted
set.seed(123456789)
splitted = split(OakMaple)
Oak = splitted$Oak
Maple = splitted$Maple
Oak_n = summary(Oak)$n
Maple_n = summary(Maple)$n
Area = summary(OakMaple)$window$area
lambdaOak = summary(OakMaple)$marks$intensity[[1]]
lambdaMaple = summary(OakMaple)$marks$intensity[[2]]


OakMaple = rmpoispp(50,types = c("Oak", "Maple"))
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE))
plot(OakMaple, main=NULL, cols=c("blue","red"),pch=20)
plot(Oak,main=NULL,cols=c("blue","red")[1],pch=20)
#title(main = TeX(paste("The Point Process of the Oaks in Figure 1 and the density estimator", lambdaOak)), line = 0.5)
plot(Maple,main=NULL,cols=c("blue","red")[2],pch=20)
#title(main = TeX(paste("The Point Process of the Maples  in Figure 1 and the density estimator", lambdaMaple)), line = 0.5)
```

```{r RUN homogenous and inhomogenous}
# homogenous and inhomogenous
set.seed(123456789)

homo = rpoispp(20, win = square(r=2))
unitname(homo) = list("metre", "metres",1)
plot(homo, main = "",  pch = 20)
title(main = TeX('Poisson Point Process created with rate $\\lambda = 20$'),line = 0.5)
lab = function(x,y){
    #return(exp(-x^2-y^2))
    return(x+100*y^2)
}
inhomo = rpoispp(lab ,win = square(r=2))
unitname(inhomo) = c("metre", "metres")
plot(inhomo, xlab = "", ylab = "", main = "",  pch = 20)
title(main = TeX('Poisson Point Process created with rate $\\lambda(x,y) = x+100y^2$'),line = 0.5)

#plot(Kest(homo)$theo~Kest(homo)$r)
```

```{r RUN counter example count statistic}
# counts statistic
set.seed(123456789)

X = rmpoint(c(50,150))
# plot(X)
# identify(X)

X1 = subset(X,marks == 1) # 2 levels
# splitted = split(X)
# X1 = splitted$'1' # 1 level
X2 = X[197]
Y = superimpose(X1,X2)

unitname(X) = list("metre", "metres",1)
unitname(Y) = unitname(X)



png(filename = 'fig_counter_example_count_statistic_X.png', width = 720, height = 720)
par(oma=c(0,0,0,0))
plot(X, main = "",cols = c("blue", "red"),  pch = 20, cex = 1.5)
title(main = TeX('Marked Poisson Point Process X with 200 points'), sub = TeX('50 points of phenotype 1 and 150 point of phenotype 2'),line = 0.5)
dev.off()
png(filename = 'fig_counter_example_count_statistic_Y.png', width = 720, height = 720)
par(oma=c(0,0,0,0))
plot(Y, main = "",cols = c("blue", "red"),  pch = 20, cex = 1.5)
title(main = TeX('Marked Poisson Point Process Y with 51 points'), sub = TeX('50 points of phenotype 1 and 1 point of phenotype 2'),line = 0.5)
dev.off()

getwd()

# title(main = TeX('Poisson Point Process created with rate $\\lambda = 20$'),line = 0.5)

# title(main = TeX('Poisson Point Process created with rate $\\lambda(x,y) = x+100y^2$'),line = 0.5)

#plot(Kest(homo)$theo~Kest(homo)$r)
```

```{r RUN counter example count area}
# counts and area
set.seed(123456789)

X = rmpoint(c(50,150))
Z = X
Window(X) = square(r=1)
Window(Z) = square(r=2)



png(filename = 'fig_counter_example_count_area_X.png', width = 720, height = 720)
par(oma=c(0,0,0,0))
plot(X, main = "",cols = c("blue", "red"),  pch = 20, cex = 2)
title(main = TeX('Marked Poisson Point Process X with 200 points in the unit square observation window'), sub = TeX('50 points of phenotype 1 and 150 point of phenotype 2'),line = 0.5)
dev.off()
png(filename = 'fig_counter_example_count_area_Z.png', width = 720, height = 720)
par(oma=c(0,0,0,0))
plot(Z, main = "",cols = c("blue", "red"),  pch = 20, cex = 2)
title(main = TeX('Marked Poisson Point Process Z with 200 points in a $2 \\times 2$ units observation window'), sub = TeX('50 points of phenotype 1 and 150 point of phenotype 2'),line = 0.5)
dev.off()

getwd()


# title(main = TeX('Poisson Point Process created with rate $\\lambda = 20$'),line = 0.5)

# title(main = TeX('Poisson Point Process created with rate $\\lambda(x,y) = x+100y^2$'),line = 0.5)

#plot(Kest(homo)$theo~Kest(homo)$r)
```
```{r RUN example pairwise relative count statistic}
# counts and area
set.seed(123456789)


V = rmpoint(c(10,50,10))
W1 = split(V)$'1'
W23 = rmpoint(c(20,40), types = c('2','3'))
W2 = split(W23)$'2'
W3 =split(W23)$'3'
W = superimpose('1' =  W1,'2' =  W2,'3' =  W3)


png(filename = 'fig_example_pairwise_relative_count_V.png', width = 720, height = 720)
par(oma=c(0,0,0,0))
plot(V, main = "", cols = c("blue", "red",'green'),  pch = 20, cex = 2)
title(main = TeX('Marked Poisson Point Process V with 70 points in the unit square observation window'), sub = TeX('10 points of phenotype 1, 50 point of phenotype 2 and 10 points of phenotype 3'), line = 0.5)
dev.off()
png(filename = 'fig_example_pairwise_relative_count_W.png', width = 720, height = 720)
par(oma=c(0,0,0,0))
plot(W, main = "", cols = c("blue", "red",'green'),  pch = 20, cex = 2)
title(main = TeX('Marked Poisson Point Process V with 70 points in the unit square observation window'), sub = TeX('10 points of phenotype 1, 20 point of phenotype 2 and 40 points of phenotype 3'),line = 0.5)
dev.off()

getwd()


# title(main = TeX('Poisson Point Process created with rate $\\lambda = 20$'),line = 0.5)

# title(main = TeX('Poisson Point Process created with rate $\\lambda(x,y) = x+100y^2$'),line = 0.5)

#plot(Kest(homo)$theo~Kest(homo)$r)
```

```{r RUN quadratcounts}
#OakMaple_quadratcounts
set.seed(123456789)

X = rmpoint(c(50,150))

X1 = split(X)$'1'
X2 = split(X)$'2'
par(oma=c(0,0,0,0))
png(filename = 'fig_example_quadratcounts_X.png', width = 720, height = 720)
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE))
par(oma=c(0,0,0,0))
plot(X, main=NULL, cols  = c("blue", "red"), pch = 20)
title(main = TeX('Marked Point Process X with 200 points in the unit square observation window'), sub = TeX('50 points of phenotype 1 and 150 point of phenotype 2'), line=0.5)

plot(X1, main = NULL,cols = c("blue", "red")[1], pch = 20)
plot(quadratcount(X1), add=TRUE)
title(main = TeX("The quadratcounts of phenotype 1 of X"), sub = TeX('50 points of phenotype 1'), line=0.5)

plot(X2, main=NULL, cols = c("blue", "red")[2], pch = 20)
plot(quadratcount(X2), add=TRUE)
title(main = TeX("The quadratcounts of phenotype 2 of X"), sub = TeX('150 points of phenotype 2'), line=0.5)

dev.off()
getwd()
```

```{r RUN quadratcounts}
#OakMaple_quadratcounts
set.seed(123456789)

X = rmpoint(c(50,150))
X1 = split(X)$'1'
X2 = split(X)$'2'

png(filename = 'fig_example_quadratcounts_X_full.png', width = 720, height = 720)
par(oma=c(0,0,0,0))
plot(X, main=NULL, cols  = c("blue", "red"), pch = 20)
title(main = TeX("Marked Point Process X with 200 points in the unit square observation window "), sub = TeX('50 points of phenotype 1 and 150 point of phenotype 2'), line=0.5)
dev.off()

png(filename = 'fig_example_quadratcounts_X_split.png', width = 720, height = 720)
par(oma=c(0,0,0,0))
par(mfrow = c(1,2))
plot(X1, main = NULL,cols = c("blue", "red")[1], pch = 20)
plot(quadratcount(X1), add=TRUE)
title(main = TeX("The quadratcounts of phenotype 1 of X"), sub = TeX('50 points of phenotype 1'), line=0.5)

plot(X2, main=NULL, cols = c("blue", "red")[2], pch = 20)
plot(quadratcount(X2), add=TRUE)
title(main = TeX("The quadratcounts of phenotype 2 of X"), sub = TeX('150 points of phenotype 2'), line=0.5)

dev.off()
getwd()
```

```{r RUN emptyspace}
# OakMaple_emptyspace
set.seed(123456789)

par(mfrow = c(1,2))
plot(OakMaple, main=NULL, cols=c("blue","red"),pch=20)
title("A Marked Point Process on the distribution of Oak and Maple trees", line = 0)
plot(Fest(OakMaple), main= NULL)
title("The Empty Space function for the Marked Point Process", line = 0)
plot(envelope(OakMaple,Fest))

```
```{r NOT RUN good plot and bad plot because of too many phenotypes}
data(lansing)
# good plot because of 3 phenotypes
plot(alltypes(superimpose(blackoak = split(lansing)$blackoak,maple = split(lansing)$maple,hickory = split(lansing)$hickory)), samex = TRUE)
# bad plot because of 4 phenotypes
plot(alltypes(superimpose(blackoak = split(lansing)$blackoak,maple = split(lansing)$maple,hickory = split(lansing)$hickory,misc = split(lansing)$misc)),samex = TRUE)

```
